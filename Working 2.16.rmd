
```{r}
library(ggplot2)
```

```{r}
df <- read.csv("athlete_events-Olympic Dataset.csv")
```


```{r}
library(dplyr)
library(tidyr)
```
```{r}
# Count medals by country (excluding NAs)
medal_counts <- df %>%
  filter(!is.na(Medal)) %>%
  group_by(NOC) %>%
  summarise(Total_Medals = n()) %>%
  arrange(desc(Total_Medals)) %>%
  head(10)

ggplot(medal_counts, aes(x = reorder(NOC, Total_Medals), y = Total_Medals)) +
  geom_col(fill = "#FFD700") +
  coord_flip() +
  theme_minimal() +
  labs(title = "Top 10 Countries by Total Medals (All-Time)",
       x = "Country", y = "Total Medals")
```

```{r}
# Count athletes per year by gender
participation <- df %>%
  group_by(Year, Sex) %>%
  summarise(Athletes = n_distinct(ID), .groups = 'drop')

ggplot(participation, aes(x = Year, y = Athletes, color = Sex)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  theme_minimal() +
  labs(title = "Olympic Participation Over Time",
       subtitle = "Number of Athletes by Gender",
       x = "Year", y = "Number of Athletes") +
  scale_color_manual(values = c("M" = "#0072B2", "F" = "#D55E00"))
```

```{r}
# Filter for top 10 sports and remove NAs
top_sports <- df %>%
  group_by(Sport) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count)) %>%
  head(10) %>%
  pull(Sport)

sport_body <- df %>%
  filter(Sport %in% top_sports, !is.na(Height), !is.na(Weight))

ggplot(sport_body, aes(x = Height, y = Weight, color = Sport)) +
  geom_point(alpha = 0.3) +
  theme_minimal() +
  labs(title = "Athlete Body Types by Sport",
       x = "Height (cm)", y = "Weight (kg)")
```
```{r}
season_participation <- df %>%
  group_by(Year, Season) %>%
  summarise(Athletes = n_distinct(ID), .groups = 'drop')

ggplot(season_participation, aes(x = Year, y = Athletes, color = Season)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  theme_minimal() +
  labs(title = "Summer vs Winter Olympics Participation",
       x = "Year", y = "Number of Athletes") +
  scale_color_manual(values = c("Summer" = "#E69F00", "Winter" = "#56B4E9"))
```
```{r}
library(ggplot2)
library(dplyr)

# Count medals per athlete
top_athletes <- df %>%
  filter(!is.na(Medal)) %>%
  group_by(Name, Sex, Sport) %>%
  summarise(
    Gold = sum(Medal == "Gold"),
    Silver = sum(Medal == "Silver"),
    Bronze = sum(Medal == "Bronze"),
    Total = n(),
    .groups = 'drop'
  ) %>%
  arrange(desc(Total)) %>%
  head(10)

# Reshape data for stacked bar chart
top_athletes_long <- top_athletes %>%
  select(Name, Gold, Silver, Bronze) %>%
  pivot_longer(cols = c(Gold, Silver, Bronze), 
               names_to = "Medal_Type", 
               values_to = "Count") %>%
  mutate(Medal_Type = factor(Medal_Type, levels = c("Gold", "Silver", "Bronze")))

# Create the plot
ggplot(top_athletes_long, aes(x = reorder(Name, Count), y = Count, fill = Medal_Type)) +
  geom_col() +
  coord_flip() +
  theme_minimal() +
  scale_fill_manual(values = c("Gold" = "#FFD700", 
                                "Silver" = "#C0C0C0", 
                                "Bronze" = "#CD7F32")) +
  labs(title = "Top 10 Olympic Athletes of All Time",
       subtitle = "By Total Medal Count",
       x = "", 
       y = "Number of Medals",
       fill = "Medal Type") +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.text.y = element_text(size = 11),
    legend.position = "bottom"
  )
```


